var Partner=ExtraView.extend({namespace:'partner',extraOnEnter:function($container){var _this=this;initHeaderTitle($container);partnerInitClouds($container);initSectionTitle($container);initScrollContent($container);this.imagesLoaded=!0;$window.trigger("extra:responsiveImage:init",[$container])},getTimelineIn:function(){var deferred=Barba.Utils.deferred(),$container=$(this.container),timeline=new TimelineMax();if(app.previousView&&app.previousView.namespace==='partner'){timeline.set($container,{clearProps:'visibility',zIndex:2,position:'absolute',top:0,left:0,width:'100%'});$container.find('.header .title').addClass('anim-letters-completed');timeline.set($("#transition-mask2,#transition-mask1"),{clearProps:'all'});timeline.add(function(){$('#barba-wrapper').find('.barba-container').not($container).remove();TweenMax.set($container,{clearProps:'all'})});timeline.add(function(){deferred.resolve()});timeline.add(function(){$(window).trigger('extra:scrollanimator:resize');$(window).trigger('extra:sticky:resize')});timeline.staggerTo($container.find('.mask').get().reverse(),1,{scaleX:0,ease:Quad.easeInOut},0.1,'+=0.5')}else{timeline.add(function(){transitionIn($container)});timeline.set($container.find('.mask'),{scaleX:0});timeline.staggerFrom($container.find('.header .cloud'),1.2,{yPercent:20,opacity:0,ease:Back.easeOut.config(1)},0.2,0);timeline.call(function(){deferred.resolve()})}
return{deferred:deferred.promise,timeline:timeline}},getTimelineOut:function(){if(extra_partner_urls.indexOf(Barba.Pjax.getCurrentUrl())!==-1){var $container=$(app.currentContainer),timeline=new TimelineMax(),offset=$container.find('.page-wrapper').offset().top-80,scroll=$(window).scrollTop();if(window.innerWidth<690){offset-=60}
timeline.to(window,Math.max(0.2,Math.abs(scroll-offset)/500),{scrollTo:offset,ease:Quad.easeInOut});timeline.staggerTo($container.find('.mask'),0.6,{scaleX:1},0.1);return timeline}else{return transitionOut()}}});Partner.init();function partnerInitClouds($container){var
isActive=!0,allowUpdate=!0,$window=$(window),scrollTop=0,lastScroll=0,$cloud=$container.find('.header .cloud'),$wrapper=$container.find('.header-wrapper'),wWidth=0,wHeight=0,material=new THREE.MeshPhongMaterial({color:0xffffff,shading:THREE.FlatShading}),renderers=[],clouds=[],fov=30,url=$cloud.data("url"),renderer,scene,camera,cloud,loader=new THREE.OBJLoader();scene=new THREE.Scene();camera=new THREE.PerspectiveCamera(fov,wWidth/wHeight);camera.position.z=30;renderer=new THREE.WebGLRenderer({resolution:1,alpha:!0,antialias:!0});renderer.setSize(wWidth,wHeight);$cloud.append(renderer.domElement);renderers.push({renderer:renderer,camera:camera});var light=new THREE.HemisphereLight(0xFFFFFF,0x69a070,1);light.position.set(5,5,2);scene.add(light);var pointLight=new THREE.PointLight(0x63b06d,1.4,8);pointLight.position.set(-3,4,3);pointLight.castShadow=!1;scene.add(pointLight);function init(){clouds.forEach(function(item,index){item.material=material;item.castShadow=!1;item.receiveShadow=!1;scene.add(item)});renderer.clear();render()}
function render(){if(!isActive){return}
requestAnimationFrame(render);if(!allowUpdate){return}
var percent=((((lastScroll-scrollTop)/wHeight)));clouds.forEach(function(item,index){if(index===0){item.rotateX(percent*0.3);item.rotateY(percent*-4)}
if(index===1){item.rotateX(percent/4);item.rotateY(percent*10);item.rotateZ(percent*2)}
if(index===2){item.rotateX(percent*10);item.rotateY(percent*-4);item.rotateZ(percent*2)}
if(index===3){item.rotateX(percent*0.6);item.rotateY(percent*6)}});renderer.render(scene,camera);lastScroll=scrollTop}
loader.load(url,function(object){object.traverse(function(child){if(child instanceof THREE.Mesh){clouds.push(child)}});init()});function scrollHandler(){scrollTop=$window.scrollTop();allowUpdate=!0}
$window.on("scroll",scrollHandler);function resizeHandler(event){wWidth=$wrapper.outerWidth();wHeight=$wrapper.outerHeight();renderers.forEach(function(renderer){renderer.renderer.setSize(wWidth,wHeight);renderer.camera.aspect=wWidth/wHeight;renderer.camera.updateProjectionMatrix()})}
$window.on("extra:resize",resizeHandler);resizeHandler();function destroy(){if(!isActive||app.currentContainer===$container[0]){return}
isActive=!1;clouds.forEach(function(cloud){cloud.parent.remove(cloud);cloud=null});clouds=null;scene=null;renderer=null;camera=null;$window.off("extra:resize",resizeHandler);$window.off("scroll",scrollHandler)}
Barba.Dispatcher.on("transitionCompleted",destroy)}