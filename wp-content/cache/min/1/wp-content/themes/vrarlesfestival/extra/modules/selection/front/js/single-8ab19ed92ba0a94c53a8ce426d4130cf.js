var SelectionSingle=ExtraView.extend({namespace:'selection-single',internalFrom:'next',extraOnEnter:function($container){var _this=this;initSectionTitle($container);selectionInitNavigation($container);selectionInitSticky($container);selectionInitScroll($container);this.imagesLoaded=!0;$window.trigger("extra:responsiveImage:init",[$container]);TweenMax.set($container,{clearProps:'visibility'})},getTimelineIn:function(){var deferred=Barba.Utils.deferred(),$container=$(this.container),timeline=new TimelineMax(),$playerInner=$container.find('.player-inner');if(app.previousView&&app.previousView.namespace==='selection-single'){timeline.set($("#transition-mask2,#transition-mask1"),{clearProps:'all'});timeline.set($container,{clearProps:'visibility',zIndex:2,position:'absolute',top:0,left:0,width:'100%'});timeline.add(function(){$container.trigger("extra:selection:ready")});if($playerInner.length){if(SelectionSingle.internalFrom==='next'){timeline.set($playerInner,{transformOrigin:'top left'})}else{timeline.set($playerInner,{transformOrigin:'top right'})}
timeline.from($playerInner,0.7,{scaleX:0,ease:Power3.easeInOut,clearProps:'transform'},'+=0.2');timeline.add(function(){$playerInner.addClass('player-transitioned');selectionInitPlayer($container)})}
timeline.add(function(){$('#barba-wrapper').find('.barba-container').not($container).remove();TweenMax.set($container,{clearProps:'all'})});timeline.add(function(){$(window).trigger('extra:sticky:resize');$(window).trigger('extra:scrollanimator:resize')})}else{$(window).one("extra:transition:transitionout",function(){timeline.set($("#transition-mask2,#transition-mask1"),{clearProps:'all'})});SelectionSingle.internalFrom='next';$('#barba-wrapper').find('.barba-container').not($container).remove();timeline.set($("#transition-mask2,#transition-mask1"),{clearProps:'all'});timeline.set(window,{scrollTo:0});timeline.set($container,{clearProps:'visibility'});timeline.add(function(){$(window).trigger('extra:sticky:resize');$(window).trigger('extra:scrollanimator:resize')});timeline.add(function(){$container.trigger("extra:selection:ready")});if($playerInner.length){timeline.from($playerInner,0.7,{scaleX:0,ease:Power2.easeInOut,clearProps:'transform'});timeline.add(function(){$playerInner.addClass('player-transitioned');selectionInitPlayer($container)})}
timeline.staggerFrom($container.find('.nav-button'),0.3,{scale:0},0.2,'+=0.2')}
return{deferred:deferred.promise,timeline:timeline}},getTimelineOut:function(){var $container=$(app.currentContainer),$player=$container.find('.player-inner'),timeline;if(Barba.Pjax.getCurrentUrl().indexOf(extra_selection_params)>=0&&Barba.Pjax.getCurrentUrl().length!==extra_selection_params.length){var playerWidth=$player.width(),playerHeight=$player.height(),scroll=$(window).scrollTop();timeline=new TimelineMax();if(scroll>0){timeline.to(window,scroll/1000,{scrollTo:0,ease:Quad.easeInOut})}
var baseRect='rect(0px '+playerWidth+'px '+playerHeight+'px 0px)',targetRect='';timeline.set($player,{clip:baseRect});if(SelectionSingle.internalFrom==='next'){targetRect='rect(0px '+playerWidth+'px '+playerHeight+'px '+playerWidth+'px)'}else{targetRect='rect(0px 0px '+playerHeight+'px 0px)'}
timeline.to($player,0.7,{clip:targetRect,ease:Power2.easeInOut},'+=1');return timeline}else{timeline=transitionOut();timeline.set($(app.currentContainer),{visibility:'hidden'});return timeline}}});SelectionSingle.init();function selectionInitNavigation($container){var
isActive=!0,$close=$container.find('.nav-button.close-button'),$next=$container.find('.nav-button.next-button'),$previous=$container.find('.nav-button.previous-button'),$playerWrapper=$container.find('.player-wrapper'),$player=$container.find('.player-inner-ratio');function update(){if(window.innerWidth>690){TweenMax.set($close,{top:($player.offset().top-$playerWrapper.offset().top)/2-$close.height()/2});TweenMax.set([$next,$previous],{clearProps:'all'})}else{TweenMax.set([$close,$next,$previous],{top:($player.offset().top-$playerWrapper.offset().top)/2-$close.height()/2})}}
$(window).on('extra:resize',update);$container.on("extra:selection:ready",update);update();$container.find('.nav-button.next-button').on("click",function(){SelectionSingle.internalFrom="next"});$container.find('.nav-button.previous-button').on("click",function(){SelectionSingle.internalFrom="previous"});$container.find('.nav-button').each(function(){var $button=$(this),$target=$container.find('.mega-titles').find('.'+$button.data("target")),introComplete=!1,isAnimating=!1,requestOut=!1,requestIn=!1;$button.on("mouseenter",function(){if(requestOut){requestOut=!1}
if(!isAnimating){requestIn=!1;requestOut=!1;isAnimating=!0;introComplete=!1;generateTimelineIn($target)}else{requestIn=!0}}).on("mouseleave",function(){if(requestIn){requestIn=!1}
if(introComplete){requestOut=!1;requestIn=!1;introComplete=!1;generateTimelineOut($target)}else{requestOut=!0}});function generateTimelineIn(){var timeline=new TimelineMax();timeline.set($target,{opacity:1});timeline.staggerFromTo($target.find('.letter'),0.6,{cycle:{yPercent:function(index){return((index%2)?-110:110)}}},{cycle:{yPercent:function(index){return((index%2)?0:0)}},clearProps:'all'},0.05,'-=1');timeline.add(function(){introComplete=!0;if(requestOut){isAnimating=!0;introComplete=!1;requestOut=!1;generateTimelineOut()}})}
function generateTimelineOut(){var timeline=new TimelineMax();timeline.staggerTo($target.find('.letter'),0.6,{cycle:{yPercent:function(index){return((index%2)?110:-110)}}},0.05,'-=1');timeline.set($target.find(".letters"),{clearProps:'all'});timeline.set($target,{opacity:0});timeline.add(function(){isAnimating=!1;if(requestIn){isAnimating=!0;introComplete=!1;requestIn=!1;generateTimelineIn()}})}
Barba.Dispatcher.on("initStateChange",function(){if(isActive){$button.trigger("mouseleave")}})});function destroy(){if(!isActive||app.currentContainer===$container[0]){return}
isActive=!1;$(window).off('extra:resize',update);$container.off("extra:selection:ready",update)}
Barba.Dispatcher.on("transitionCompleted",destroy)}function selectionInitPlayer($container){var $player=$container.find('.player').first(),$playerInner=$container.find('.player-inner'),player,videoType,videoID,startAt=0;if($player.length){videoType=$player.data("video-type");videoID=$player.data("video-id");startAt=$player.data("video-start");if(videoType==='youtube'){if(typeof(YT)==='undefined'||typeof(YT.Player)==='undefined'){window.onYouTubeIframeAPIReady=function(){loadYouTubePlayer()}}else{loadYouTubePlayer()}}else{loadVimeoPlayer()}}
function loadYouTubePlayer(){player=new YT.Player($player[0],{height:'360',width:'640',videoId:videoID,playerVars:{start:startAt,modestbranding:1,rel:0},events:{onReady:function(){$playerInner.addClass('player-loaded')}}})}
function loadVimeoPlayer(){player=new Vimeo.Player($player[0],{id:videoID,width:640,height:360,loop:!1,color:"#a3d5bd"});player.on("loaded",function(){player.setCurrentTime(startAt);$playerInner.addClass('player-loaded')})}}function selectionInitScroll($container){var isActive=!0,scrollAnimators=[];scrollAnimators.push(new ExtraScrollAnimator({target:$container.find('.metas-content'),tween:new TimelineMax().staggerFrom($container.find('.metas-content .meta-line'),1,{y:60,ease:Linear.easeNone},0.1),speed:0.6,min:0,max:0.1,ease:Quad.easeOut}));scrollAnimators.push(new ExtraScrollAnimator({target:$container.find('.directors-wrapper'),tween:new TimelineMax().staggerFrom($container.find('.directors-wrapper').find('.director-image, .director-name, .director-content'),1,{y:120,ease:Linear.easeNone},0.2),speed:0.3,min:0,max:0.1,ease:Quad.easeOut}));scrollAnimators.push(new ExtraScrollAnimator({target:$container.find('.selection-content-inner'),tween:new TimelineMax().staggerFrom($container.find('.selection-content-inner').find('.selection-title, .content > *'),1,{y:120,ease:Linear.easeNone},0.2),speed:0.3,min:0,max:0.1,ease:Quad.easeOut}));function destroy(){if(!isActive||app.currentContainer===$container[0]){return}
isActive=!1;scrollAnimators.forEach(function(scrollAnimator,index){scrollAnimator.destroy()})}
Barba.Dispatcher.on("transitionCompleted",destroy)}function selectionInitSticky($container){var isActive=!0,stick,$inner=$container.find('.selection-content-inner');stick=$inner.stick_in_parent({offset_top:80});function destroy(){if(!isActive||app.currentContainer===$container[0]){return}
isActive=!1;stick.detach()}
Barba.Dispatcher.on("transitionCompleted",destroy)}